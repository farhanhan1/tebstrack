<!DOCTYPE html>
<html>
<head>
    <title>JavaScript Test</title>
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
</head>
<body>
    <h1>JavaScript Test Page</h1>
    
    <div>
        <a href="#" onclick="toggleHistory(this); return false;" style="color:blue; text-decoration:underline;">Show message history</a>
        <div class="message-history" style="display:none; margin-top:10px; background:#f0f0f0; padding:10px; border:1px solid #ccc;">
            <p>This is the hidden message history content!</p>
        </div>
    </div>
    
    <div style="margin-top: 20px;">
        <button onclick="testFunction()">Test Basic Function</button>
    </div>
    
    <div id="output" style="margin-top: 20px; padding: 10px; background: #f9f9f9; border: 1px solid #ddd;">
        <p>Output will appear here...</p>
    </div>

    <script>
        console.log('Test script loading...');
        
        // Basic test function
        function testFunction() {
            document.getElementById('output').innerHTML = '<p>JavaScript is working! Time: ' + new Date() + '</p>';
            console.log('testFunction called');
        }
        
        // Toggle message history functionality
        window.toggleHistory = function(element) {
            console.log('toggleHistory called with:', element);
            var historyDiv = element.parentNode.querySelector('.message-history');
            console.log('Found historyDiv:', historyDiv);
            if (historyDiv) {
                if (historyDiv.style.display === 'none' || historyDiv.style.display === '') {
                    historyDiv.style.display = 'block';
                    element.textContent = 'Hide message history';
                    console.log('Showing history');
                } else {
                    historyDiv.style.display = 'none';
                    element.textContent = 'Show message history';
                    console.log('Hiding history');
                }
            } else {
                console.log('No message-history div found');
            }
        }
        
        // Test that the function is available
        console.log('toggleHistory function defined:', typeof window.toggleHistory);
        
        // Display function status on page
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('output').innerHTML = '<p>toggleHistory function type: ' + typeof window.toggleHistory + '</p>';
        });
    </script>
</body>
</html>
